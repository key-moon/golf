def	p(g):
	c=max(g)[0]
	for	_	in	range(2):g=[*zip(*[(l:=c)and[(v==l!=c)*(l:=v)for*t,v in	zip(*g,s)if	all(t)+_]for	s	in	g	if	all(s)+_])]
	for	_	in	range(40):g=[*zip(*g[any(g[-1])-2::-1])]
	return	g