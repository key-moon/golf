def	p(g):w=len(g[0]);o=next(c	for	c	in	range(w)if	all(g[r][c]==g[0][c]for	r	in	range(len(g)))and	g[0][c]!=0);v=[A[:o]for	A	in	g];A=[A[o+1:][::-1]for	A	in	g];return[[l	if	l!=0else	r	for(l,r)in	zip(A,b)]for(A,b)in	zip(v,A)]