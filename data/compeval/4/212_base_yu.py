p=lambda	g,c=-3:c*g	or	p([*zip(*[(t:=0)or[(t:=[max(t,v),t>0][v==1])%5|v	for	v	in	s][::-1]for	s	in	zip(*g)])],c+1)