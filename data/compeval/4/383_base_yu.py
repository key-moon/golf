p=lambda	g,c=-3:c*g	or	p([1<len(a:=[*filter(int,s)])<len(s)and	a[0]!=a[1]and[a[0**v]for	v	in	s]or	s	for	s	in	zip(*g[::-1])],c+1)