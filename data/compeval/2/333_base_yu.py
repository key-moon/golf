p=lambda	g,c=-3:c*g	or	p([[s[i]or(3in	s[:i])*max(s[i:])for	i	in	range(10)]for	s	in	zip(*g[::-1])],c+1)