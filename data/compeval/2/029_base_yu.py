p=lambda	g,c=0:-~-(c	in	sum(u:=[[v	for*t,v in	zip(*g,s)if	c	in	t][1:-1]for	s	in	g	if	c	in	s][1:-1],[]))*u	or	p(g,c+1)