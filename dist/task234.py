p=lambda g,c=-3,s=[0]:g*c or p([*zip(*[s:=r for r in g+g[:1]*99if(max(r)in s)>=(sum(r)in r)][len(g)-1::-1])],c+1)