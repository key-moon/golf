p=lambda g,E=enumerate,a=abs:[[(s:=[(i,j,v)for(i,r)in E(g)for(j,v)in E(r)if v],m:=min(d:=[a(i-x)+a(j-y)for(x,y,_)in s]),c:=s[d.index(m)],c[2]*(max(a(i-c[0]),a(j-c[1]))%2+1<2>d.count(m)))[3]for(j,_)in E(r)]for(i,r)in E(g)]