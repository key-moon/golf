p=lambda g,c=-3:c*g or p([[[l*s[0]or v,v][l:=l*(v!=8)]for v in s]for s in zip(*g[::-1])if(l:=1)],c+1)