p=lambda g,c=35,f=0:g*-c or c<4and[*zip(*[[v or(f<s[1:-1].count(1)**3)*2for v in s]*(f:=1)for s in p(g,c-1)][::-1])]or[*zip(*p([*zip(*g[any(g[-1])-2::-1])],c-1))][::-1]+g[-1:]