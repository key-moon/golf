p=lambda g,c=-9:c*g or p([[[*{*s}-{9},9][0]for s in zip(r,[9]*2+r[::-1],R)]for*R,r in zip(*g,g)],c+1)