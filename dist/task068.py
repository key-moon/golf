p=lambda g,c=-3,l=0:c*g or[[[(l>0)*2,l:=y*(y==min(u:=sum(g,[]),key=u.count)or c<0)][l>0]for y in s]for s in zip(*p(g,c+1)[::-1])]