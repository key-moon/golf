p=lambda g,c=-3,l=0:c*g or p([[(l>0)|(l:=y)for y in s]for s in zip(*g[::-1])],c+1)