A=enumerate
def p(g):B=[i for(i,r)in A(g)if any(r)];C=[i for(i,c)in A(zip(*g))if any(c)];D=[r[C[0]:C[-1]+1]for r in g[B[0]:B[-1]+1]];E,F=set(x for A in D for x in A);return[[F if x==E else E for x in A]for A in D]