p=lambda g,c=-63:g*c or p([[v*(v>1)for v in s]for s in zip(*g[any(g[-1])-2::-1])],c+1)