p=lambda g:[(D:=0)or[int(D:=[3*(0<D),.5-(0!=D)][1<c])for c in r]for r in g]