p=lambda g,c=-7:c*g or[g:=[V*(v>0<V==U)or(0<V+w)*v for V,w,v,U in zip([0,*s],s[1:]*2,s,g*9)]for s in zip(*p(g,c+1))][::-1]