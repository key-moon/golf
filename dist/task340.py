p=lambda g,c=-3:c*g or p([[v*(v in s[:2]+g[0]+g[1])for v in s]+[max({a,b}&{*s}),b]for*s,a,b in zip(*g)][::-1],c+1)