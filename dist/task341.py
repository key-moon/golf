p=lambda g,c=-1,E=enumerate:c*g or p([*zip(*[[v or(g[k-1]==s==g[(k+1)%10]!={0}<{*s[i:]}<{*s})*8for i,v in E(s)]for k,s in E(g)])],c+1)