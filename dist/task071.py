p=lambda g,c=0:({*map(len,x:=[sum([[*{s[j],(s+g[0])[c-j]}&{*max(g,key=any)}]for j in range(16)],[])for s in g])}=={16})*x or p(g,c+1)