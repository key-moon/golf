A=range
p=lambda g:[x for p in A(32)if min(map(len,x:=[[sum(t)for j in A(16)if len(t:={s[j],(s+g[0])[p-j]}&{0,[*filter(int,sum(g,[]))][0]})<2]for s in g]))>15][0]