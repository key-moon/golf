p=lambda g,c=-1:c*g or[1<(t:=sum(map(bool,s)))and[sum(s[i%t::t])for i in range(len(s))]or s for s in zip(*p(g,c+1))]