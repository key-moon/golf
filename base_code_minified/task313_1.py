def p(A):C=A[-1][-1];D=next(A for(A,B)in enumerate(A)if all(A==C for A in B));B=[];[B.append(A)for A in A[0][:D]if A not in B];return[[B[(C+A+1)%len(B)]for A in range(len(A[0]))]for C in range(len(A))]