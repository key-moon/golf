def p(g):A=next(A for(A,B)in enumerate(g)if len({*B})<2);B=next(A for A in range(len(g[0]))if len({g[B][A]for B in range(len(g))})<2);C=[[g[C][A]for A in range(len(g[0]))if A!=B]for C in range(len(g))if C!=A];D=[B for A in C for B in A];E=max({*D},key=D.count);F,G=next((A,C)for(A,B)in enumerate(C)for(C,D)in enumerate(B)if D!=E);return[A[:B]if G<B else A[B:]for A in(C[:A]if F<A else C[A:])]