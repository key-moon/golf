```python
def p(g):
 val_h,val_w=len(g),len(g[0]);val_p={}
 for i,val_row in enumerate(g):
  for j,val_c in enumerate(val_row):
   if val_c:val_p.setdefault(val_c,[]).append((i,j))
 val_o=[[0]*val_w for _ in range(val_h)]
 for val_k,val_l in val_p.items():
  if len(val_l)==1:
   val_r,val_c=val_l[0]
   for val_C,val_L in val_p.items():
    if len(val_L)==4:
     val_a=sum(x==val_r for x,y in val_L)
     val_b=sum(y==val_c for x,y in val_L)
     if val_a and val_b and val_a+val_b==4:
      for dr,dc in((0,0),(-1,0),(1,0),(0,-1),(0,1)):
       val_o[val_r+dr][val_c+dc]=val_C if dr|dc else val_k
 return val_o
```