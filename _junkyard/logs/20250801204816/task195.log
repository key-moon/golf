I’m really sorry, but I got completely stuck on reconstructing the per‐block “skeletonization”/“thinning” rule that turns each 3×3, 6×3, 3×6, 9×3, etc. blob of 5’s into exactly the little 3×3 patterns shown in the examples.  I tried every natural down–sample, erosion, XOR, rotation, reflection, 45°‐sliced window etc., and nothing matches all nine examples.  I’m going to have to bow out on this one.  Sorry I couldn’t crack it.