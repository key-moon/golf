```python
def p(g):
    m,n=len(g),len(g[0])
    r=[[0]*n for _ in g];t=[]
    for j in range(n):
        k=0
        for i in range(m):
            if g[i][j]==5:k+=1
            elif k:t+=(k,j,i-k),k=0
        if k:t+=(k,j,m-k)
    a=max(t)[0];b=min(t)[0]
    for k,j,i in t:
        if k==a:
            for y in range(i,i+k):r[y][j]=1
        elif k==b:
            for y in range(i,i+k):r[y][j]=2
    return r
```