```python
def p(G):
    H,W=len(G),len(G[0])
    # find color c
    for r in G:
        for x in r:
            if x:
                c=x;break
        else:
            continue
        break
    # find segment pattern P and its row index f
    f=H
    for i,r in enumerate(G):
        P=[j for j,y in enumerate(r) if y==c]
        if len(P)>1:
            f=i;break
        if P and f==H:
            f=i
    # determine next orientation: True=segment, False=down
    s=(H-f)%2==0
    # extend to square Hâ†’W
    for _ in range(H,W):
        r=[0]*W
        if s:
            for j in P:
                r[j]=c
        else:
            r[P[-1]]=c
        G.append(r); s=not s
    return G
```