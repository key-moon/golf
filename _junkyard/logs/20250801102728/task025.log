```python
def p(g):
 R,C=len(g),len(g[0]);d={}
 for i in range(R):
  for j in range(C):
   x=g[i][j]
   if x:d.setdefault(x,[]).append((i,j))
 r=[[0]*C for _ in range(R)]
 for x,L in d.items():
  r0=max({i for i,j in L},key=lambda u:sum(i==u for i,j in L));lr=sum(i==r0 for i,j in L)
  c0=max({j for i,j in L},key=lambda v:sum(j==v for i,j in L));lc=sum(j==c0 for i,j in L)
  if lr+lc>2:
   if lc>lr:
    for i,j in L:
     if j==c0:r[i][j]=x
     else:r[i][c0+(j>c0 and 1 or -1)]=x
   else:
    for i,j in L:
     if i==r0:r[i][j]=x
     else:r[r0+(i>r0 and 1 or -1)][j]=x
 return r
```