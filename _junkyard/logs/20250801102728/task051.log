```python
def p(g):
 f=sum(g,[])
 v=next(x for x in f if f.count(x)<2)
 m,n=len(g),len(g[0])
 i,j=next((i,j)for i,r in enumerate(g)for j,x in enumerate(r)if x==v)
 d=max((0,1),(0,-1),(1,0),(-1,0),
   key=lambda t:sum(0<=i+t[0]*k<m and 0<=j+t[1]*k<n and g[i+t[0]*k][j+t[1]*k]==0
                     for k in range(1,m+n)))
 for k in range(1,m+n):
  a,b=i+d[0]*k,j+d[1]*k
  if 0<=a<m and 0<=b<n and g[a][b]==0:g[a][b]=v
 return g
```