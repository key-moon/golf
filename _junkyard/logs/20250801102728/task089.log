```python
def p(g):
 d={}
 for i,r in enumerate(g):
  for j,v in enumerate(r):
   if v:d.setdefault(v,[]).append((i,j))
 h,w=len(g),len(g[0])
 for v,ps in d.items():
  if len(ps)<2:continue
  for u,qs in d.items():
   if u==v:continue
   cl={p0:[]for p0 in ps}
   for i,j in qs:
    p0=min(ps,key=lambda t:abs(i-t[0])+abs(j-t[1]))
    cl[p0].append((i,j))
   L=[p0 for p0 in ps if cl[p0]]
   if len(L)==1 and len(cl[L[0]])>1:
    i0,j0=L[0];o=[(i-i0,j-j0)for i,j in cl[L[0]]]
    for i,j in ps:
     if (i,j)!=L[0]:
      for di,dj in o:
       x,y=i+di,j+dj
       if 0<=x<h and 0<=y<w and g[x][y]==0:g[x][y]=u
 return g
```