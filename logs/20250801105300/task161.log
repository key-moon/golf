```python
def p(g):
    # collect positions of each non-zero color
    pos = {}
    for i, row in enumerate(g):
        for j, v in enumerate(row):
            if v:
                pos.setdefault(v, []).append((i, j))
    # pick the color that occurs exactly 4 times
    c = next(v for v, lst in pos.items() if len(lst) == 4)
    # unzip its four positions
    ys, xs = zip(*pos[c])
    R, C = set(ys), set(xs)
    m, n = len(g), len(g[0])
    # start with a zero grid
    G = [[0]*n for _ in range(m)]
    # draw horizontal lines:
    if len(R) == 2:
        for r in R:
            G[r] = [c]*n
    else:
        r = max(R, key=ys.count)
        G[r] = [c]*n
    # draw vertical line only if there are 3 distinct columns
    if len(C) > 2:
        col = max(C, key=xs.count)
        for i in range(m):
            G[i][col] = c
    return G
```