```python
def p(g):
    # Group contiguous rows by their nonzero‐value sets
    t = [(i, set(r) - {0}) for i, r in enumerate(g) if set(r) - {0}]
    a = [[t[0][0]]]; k = t[0][1]
    for i, ks in t[1:]:
        (a[-1].append(i) if ks == k else a.append([i])); k = ks

    # Group contiguous columns by their nonzero‐value sets
    n, m = len(g), len(g[0])
    u = [(j, set(g[i][j] for i in range(n)) - {0}) for j in range(m)
         if set(g[i][j] for i in range(n)) - {0}]
    b = [[u[0][0]]]; k = u[0][1]
    for j, ks in u[1:]:
        (b[-1].append(j) if ks == k else b.append([j])); k = ks

    # Extract one representative nonzero from each block
    return [[next(g[i][j] for i in rs for j in cs if g[i][j])
             for cs in b]
            for rs in a]
```