```python
def p(g):
 r,c=len(g),len(g[0])
 for i in range(r):
  for j in range(c):
   for n in range(3,min(r-i,c-j)+1):
    if g[i][j:j+n]==[5]*n==g[i+n-1][j:j+n]and all(g[i+k][j:j+n:n-1]==[5,5]for k in range(n)):
     for x in range(i+1,i+n-1):
      for y in range(j+1,j+n-1):g[x][y]=n+3
 return g
```