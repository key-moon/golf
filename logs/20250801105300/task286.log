```python
def p(g):
 h,w=len(g),len(g[0]);v=[[-1]*w for _ in g]
 for i in range(h):
  for j in range(w):
   if g[i][j]!=8 and v[i][j]<0:
    d={};q=[(i,j)];v[i][j]=0
    for x,y in q:
     o=v[x][y]
     if g[x][y]:d[o]=g[x][y]
     for xx,yy in((x+1,y),(x-1,y),(x,y+1),(x,y-1)):
      if 0<=xx<h and 0<=yy<w and g[xx][yy]!=8 and v[xx][yy]<0:v[xx][yy]=1-o;q.append((xx,yy))
    for x,y in q:g[x][y]=d[v[x][y]]
 return g
```