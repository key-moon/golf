```python
def p(g):
    M = {}
    for i, row in enumerate(g):
        for j, v in enumerate(row):
            if v:
                a = M.setdefault(v, (set(), set()))
                a[0].add(i); a[1].add(j)
    h = w = 0
    for k, (rs, cs) in M.items():
        if len(rs) < len(cs):
            h = k
        else:
            w = k
    rs, cs = M[h][0], M[w][1]
    i, j = next(iter(rs)), next(iter(cs))
    d = h if g[i][j] == w else w
    for i in rs:
        for j in cs:
            g[i][j] = d
    return g
```