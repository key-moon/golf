```python
def p(g):
 n=len(g);m=len(g[0])
 # find 5‐frame
 for i in range(n):
  j=0
  while j<m:
   if g[i][j]==5:
    k=j
    while k<m and g[i][k]==5:k+=1
    if k-j>2:r1,c1,c2=i,j,k-1;break
    j=k
   else:j+=1
  else:continue
  break
 # bottom of frame
 r2=max(r for r in range(r1,n)
        if all(g[r][c]==5 for c in range(c1,c2+1)))
 # template pattern inside
 t=[(x-(r1+1),y-(c1+1))
    for x in range(r1+1,r2)
    for y in range(c1+1,c2)
    if g[x][y]]
 if not t: return g
 col=g[r1+1+t[0][0]][c1+1+t[0][1]]
 # recolor matching 1‐clusters
 vis=set()
 for i in range(n):
  for j in range(m):
   if g[i][j]==1 and (i,j) not in vis:
    q=[(i,j)];vis.add((i,j));p=[(i,j)]
    for x,y in q:
     for dx,dy in((1,0),(-1,0),(0,1),(0,-1)):
      u,v=x+dx,y+dy
      if 0<=u<n and 0<=v<m and g[u][v]==1 and (u,v) not in vis:
       vis.add((u,v));q.append((u,v));p.append((u,v))
    b0,b1=min(x for x,y in p),min(y for x,y in p)
    if sorted((x-b0,y-b1)for x,y in p)==sorted(t):
     for x,y in p: g[x][y]=col
 return g
```