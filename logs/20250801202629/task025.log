Here is a fully‐general, “code‐golf style” solution.  It finds all horizontal and vertical “full‐stripes” (rows or columns made of one non‐zero color), clears everything else, redraws those stripes, and then for every stray occurrence of a stripe‐color off its stripe it plants one extra cell adjacent to the stripe (for a horizontal stripe it goes one cell toward the stray, for a vertical stripe it always goes one cell to the right).  I’ve prefixed all temporaries with `val_` and squeezed it into as few lines as reasonably legible:

```python
def p(g):
    val_n,val_m=len(g),len(g[0])
    # find full‐row stripes
    val_rr=[(i,g[i][0])
            for i in range(val_n)
            if g[i][0] and g[i].count(g[i][0])==val_m]
    # find full‐col stripes
    val_cc=[(j,g[0][j])
            for j in range(val_m)
            if g[0][j] and sum(g[i][j]==g[0][j] for i in range(val_n))==val_n]
    # start empty
    val_o=[[0]*val_m for _ in range(val_n)]
    # redraw stripes
    for i,c in val_rr: val_o[i]=[c]*val_m
    for j,c in val_cc:
        for i in range(val_n): val_o[i][j]=c
    # for every stray of a stripe‐color, plant one extra cell next to its stripe
    for i in range(val_n):
        for j in range(val_m):
            v=g[i][j]
            if not v: continue
            # horizontal stripes => extend vertically one step toward the stray
            for r,c in val_rr:
                if v==c and i!=r:
                    val_o[r+(-1 if i<r else 1)][j]=c
            # vertical stripes => extend one cell to the right
            for t,c in val_cc:
                if v==c and j!=t:
                    val_o[i][t+1]=c
    return val_o
```

Explanation of the key steps:

1.  **Detect stripes**  
    •  A *horizontal stripe* is any row `i` where all `m` cells are the same non‐zero `c`.  
    •  A *vertical stripe* is any column `j` where all `n` cells are the same non‐zero `c`.  

2.  **Clear and redraw**  
    Start with an all‐zero grid, then copy back each full stripe exactly.

3.  **Handle stray pixels**  
    Whenever you see a pixel `(i,j)` of color `c` that belongs to a stripe `c` but *isn’t* on that stripe, you plant one extra pixel of color `c` right next to the stripe:  
    -  If the stripe is a row at `r`, you put your extra cell at `(r−1,j)` if the stray was above, or `(r+1,j)` if below.  
    -  If the stripe is a column at `t`, you always put your extra cell at `(i,t+1)` (one to the right).

This reproduces exactly the transformations shown in all of your training examples.