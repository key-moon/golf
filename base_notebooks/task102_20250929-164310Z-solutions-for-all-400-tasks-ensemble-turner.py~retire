def p(g,f=range):
 E,a=len(g),len(g[0]);t={};[[t.update({A:t.get(A,0)+1})for A in A]for A in g];r=max(t,key=t.get);L=[[0]*a for A in f(E)];h=[]
 for l in f(E):
  for D in f(a):
   if not L[l][D]and g[l][D]!=r:
    A=[];G=[(l,D)];d=g[l][D]
    while G:
     D,O=G.pop()
     if 0<=D<E and 0<=O<a and not L[D][O]and g[D][O]==d:L[D][O]=1;A.append((D,O));G.extend([(D+A,O+d)for(A,d)in[(0,1),(1,0),(0,-1),(-1,0)]])
    A and h.append(A)
 D=[]
 for A in h:
  if A:M,N,O,E=min(A[0]for A in A),max(A[0]for A in A),min(A[1]for A in A),max(A[1]for A in A);i=set((A,d)for A in f(M,N+1)for d in f(O,E+1));d=list(i-set(A));d and D.append(d)
 G=[]
 for d in D:
  if d:M,N,O,E=min(A[0]for A in d),max(A[0]for A in d),min(A[1]for A in d),max(A[1]for A in d);E,a=N-M+1,E-O+1;E==a and len(d)==E*a and G.extend(d)
 J=[A[:]for A in g]
 for(l,D)in G:0<=l<len(J)and 0<=D<len(J[0])and J.__setitem__(l,J[l][:D]+[2]+J[l][D+1:])
 return J
