from collections import Counter,deque
def p(g):
	C,A=len(g),len(g[0]);B=Counter(B for A in g for B in A);E=min(B,key=B.get);J=max(B,key=B.get);M=max((A for A in B if A!=J),key=B.get,default=J);N=[[g[B][A-1-C]for C in range(A)]for B in range(C)];F=[[g[B][A]if g[B][A]==N[B][A]else E for A in range(A)]for B in range(C)];O=F[::-1];G=[[F[B][A]if F[B][A]==O[B][A]else E for A in range(A)]for B in range(C)];H=[A for A in range(C)if len(set(G[A]))>1]
	if not H:H=list(range(C))
	P=list(zip(*G));I=[A for A in range(A)if len(set(P[A]))>1]
	if not I:I=list(range(A))
	D=[[G[A][B]for B in I]for A in H]
	for K in range(len(D)):
		for L in range(len(D[0])):
			if D[K][L]==E:D[K][L]=M
	return D