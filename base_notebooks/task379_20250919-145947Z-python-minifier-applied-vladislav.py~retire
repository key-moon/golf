def p(g):
	G=None;F=range;R,S=len(g),len(g[0]);A=[A[:]for A in g];T=8;E=2;U=[A for A in F(R)if any(A==T for A in g[A])];V=[A for A in F(S)if any(g[B][A]==T for B in F(R))];W=[(A,B)for A in F(R)for B in F(S)if g[A][B]==E]
	def K(ci,cj):
		for B in F(ci-1,ci+2):
			if 0<=B<R:
				for C in F(cj-1,cj+2):
					if 0<=C<S:A[B][C]=T
		A[ci][cj]=E
	if len(U)<=len(V):
		D=sorted(U)
		if not D:return A
		for(B,C)in W:
			if len(D)>=2:
				L=max((A for A in D if A<=B),default=G);M=min((A for A in D if A>=B),default=G)
				if L is not G and M is not G and L!=M:
					for X in F(L+2,M-1):A[X][C]=E
					A[L][C]=A[M][C]=E;K(L,C);K(M,C);continue
			N=min(D,key=lambda r:abs(r-B));H=1 if N>B else-1;I=B
			while True:
				J=I+H
				if H==1 and J>=N-1 or H==-1 and J<=N+1:break
				I=J;A[I][C]=E
			A[N][C]=E;K(N,C)
	else:
		D=sorted(V)
		if not D:return A
		for(B,C)in W:
			if len(D)>=2:
				O=max((A for A in D if A<=C),default=G);P=min((A for A in D if A>=C),default=G)
				if O is not G and P is not G and O!=P:
					for Y in F(O+2,P-1):A[B][Y]=E
					A[B][O]=A[B][P]=E;K(B,O);K(B,P);continue
			Q=min(D,key=lambda c:abs(c-C));H=1 if Q>C else-1;I=C
			while True:
				J=I+H
				if H==1 and J>=Q-1 or H==-1 and J<=Q+1:break
				I=J;A[B][I]=E
			A[B][Q]=E;K(B,Q)
	return A