def p(g):
	r=False;M=True;from collections import Counter as T,deque;t,o=len(g),len(g[0]);k=[[r]*o for A in range(t)];n=[]
	for A in range(t):
		for i in range(o):
			if g[A][i]==0 and not k[A][i]:
				x=deque([(A,i)]);k[A][i]=M;a=[];R=A==0 or i==0 or A==t-1 or i==o-1
				while x:
					b,c=x.popleft();a.append((b,c))
					for(q,d)in((1,0),(-1,0),(0,1),(0,-1)):
						u,F=b+q,c+d
						if 0<=u<t and 0<=F<o and not k[u][F]and g[u][F]==0:k[u][F]=M;R=R or(u==0 or F==0 or u==t-1 or F==o-1);x.append((u,F))
				if not R:n.append(a)
	if not n:return[A[:]for A in g]
	a=max(n,key=len);s,r,f,h=min(A for(A,i)in a),min(A for(i,A)in a),max(A for(A,i)in a),max(A for(i,A)in a);w,u,c,z=max(0,s-1),max(0,r-1),min(t-1,f+1),min(o-1,h+1);G=[A[u:z+1]for A in g[w:c+1]];d,c=len(G),len(G[0]);s=T(i for A in G for i in A);k=max(s,key=s.get);h,f,T,f=set(),None,-1,-1;A1={A for i in G for A in i if A!=k}
	for j in A1:
		C=[(A,i)for A in range(d)for i in range(c)if G[A][i]==j]
		if not C:continue
		u={}
		for(A,i)in C:
			if i in u:U,s=u[i];u[i]=min(U,A),max(s,A)
			else:u[i]=A,A
		A2={(a,A)for(A,(i,C))in u.items()for a in range(i,C+1)};u={}
		for(A,i)in C:
			if A in u:U,s=u[A];u[A]=min(U,i),max(s,i)
			else:u[A]=i,i
		A3={(A,a)for(A,(i,C))in u.items()for a in range(i,C+1)};o,e=min(A for(A,i)in C),max(A for(A,i)in C);k,x={i for(A,i)in C if A==o},{i for(A,i)in C if A==e};x=k if len(k)>=len(x)else x;r={(i,A)for(i,A)in A2 if A in x};q,A8=min(A for(i,A)in C),max(A for(i,A)in C);x,n={A for(A,i)in C if i==q},{A for(A,i)in C if i==A8};A9=n if len(n)>=len(x)else x;b={(A,i)for(A,i)in A3 if A in A9};X=r
		if len(r)>len(b):b=r
		elif len(b)>len(r):b=b;X=M
		else:b=b;X=M
		if X:
			s=set(C);Y={};AB={A for(A,i)in C}
			for(A,_)in C:Y[A]=Y.get(A,0)+1
			if len(AB)<=2:b={A for A in b if not(A not in s and Y.get(A[0],0)==2)}
		u,q=len(b)-len(C),len(b)
		if u>T or u==T and q>f:T,f,f,h=u,q,j,b
	if f is not None:
		for(A,i)in h:
			if 0<=A<d and 0<=i<c:G[A][i]=f
	return G 