def p(g):
	Q=False
	def I(a):return[list(A)for A in zip(*a)]
	def R(a):return any(len(set(A))==1 for A in a)
	A=[A[:]for A in g];J=Q
	if not R(A):A=I(A);J=True
	S,T=len(A),len(A[0]);H={}
	for D in range(S):
		for B in range(T):
			C=A[D][B]
			if C==0:continue
			H.setdefault(C,[]).append((D,B))
	K={};U={}
	for(C,E)in H.items():
		L=min(A for(A,B)in E);M=max(A for(A,B)in E);N=min(A for(B,A)in E);O=max(A for(B,A)in E);U[C]=L,M,N,O;F=set()
		for B in range(N,O+1):
			P=Q
			for D in range(L,M+1):
				if A[D][B]==0:P=True;break
			if P:F.add(B)
		K[C]=F
	G=[A[:]for A in A]
	for(C,E)in H.items():
		F=K[C]
		if not F:continue
		for(D,B)in E:
			if B in F:G[D][B]=0
	if J:G=I(G)
	return G