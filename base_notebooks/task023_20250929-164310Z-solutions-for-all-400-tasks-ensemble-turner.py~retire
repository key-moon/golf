def p(g,f=enumerate,L=range):
 s={(A,i)for(A,s)in f(g)for(i,l)in f(s)if l}
 while s:
  i={A:[]for A in s}
  for l in L(3):
   for d in L(11):
    for r in L(11):
     A={(d+[A//2,A,0][l],r+[A%2,0,A][l])for A in L((4,3,3)[l])}
     if A<=s:[i[s].append(A)for s in A]
  r=min(s,key=lambda A:len(i[A]));A=i[r][0];s-=A
  for(G,t)in A:g[G][t]=(len(A)-3)*6+2
 return g