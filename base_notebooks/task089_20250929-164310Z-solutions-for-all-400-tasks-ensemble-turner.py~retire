def p(g,i=range):
 D,o=len(g),len(g[0]);K=[r[:]for r in g];F=[[0]*o for r in i(D)];L=[]
 for G in i(D):
  for l in i(o):
   if F[G][l]or g[G][l]==0:continue
   I=[(G,l)];C=[]
   while I:
    r,S=I.pop()
    if r<0 or r>=D or S<0 or S>=o or F[r][S]or g[r][S]==0:continue
    F[r][S]=1;C.append((r,S,g[r][S]));I.extend([(r+C,S+G)for(C,G)in[(0,1),(0,-1),(1,0),(-1,0),(1,1),(1,-1),(-1,1),(-1,-1)]if 0<=r+C<D and 0<=S+G<o and not F[r+C][S+G]and g[r+C][S+G]!=0])
   C and L.append(C)
 M,h,O,P=[],[],[],[]
 for C in L:
  L={S for(r,r,S)in C}
  if len(C)==1:
   R,r,S=C[0]
   if S==2:O.append((R,r))
   elif S==3:P.append((R,r))
  else:
   if 2in L:M.append(C)
   if 3in L:h.append(C)
 def T(k,v,T,f=0):
  S=next(((r,S)for(r,S,C)in k if C==v),None)
  if not S:return
  G,l=S
  for(I,S)in T:
   for(L,M,h)in k:
    O,r=L-G,M-l
    if f:r=-r
    C,F=I+O,S+r
    if 0<=C<D and 0<=F<o:K[C][F]=h
 for S in M:T(S,2,O,1)
 for S in h:T(S,3,P)
 return K