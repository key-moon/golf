def p(a,m=range):
 q=[m[:]for m in a]
 for e in m(1,10):
  f=[(n,f)for n in m(len(a))for f in m(len(a[0]))if a[n][f]==e]
  for r in m(len(f)):
   for e in m(r+1,len(f)):
    n,l=f[r];e,t=f[e]
    if n==e:
     for e in m(min(l,t),max(l,t)+1):q[n][e]=8
    elif l==t:
     for n in m(min(n,e),max(n,e)+1):q[n][l]=8
  for(n,e)in f:q[n][e]=1
 return q