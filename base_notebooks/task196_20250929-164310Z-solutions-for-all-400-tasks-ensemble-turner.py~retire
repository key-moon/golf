def p(r):
 L=range;o,R=len(r),len(r[0]);t=set();d=[A[:]for A in r]
 def D(l,a):
  if(l,a)in t or not(0<=l<o and 0<=a<R)or r[l][a]!=1:return[]
  t.add((l,a));return[(l,a)]+sum([D(l+A,a+L)for(A,L)in[(-1,0),(1,0),(0,-1),(0,1)]],[])
 for l in L(o):
  for s in L(R):
   if r[l][s]==1and(l,s)not in t:
    A=D(l,s);e,s,E,O=min(A[0]for A in A),max(A[0]for A in A),min(A[1]for A in A),max(A[1]for A in A)
    if len(A)==2*(s-e+O-E)and s>e and O>E and any(r[A][t]==0for A in L(e+1,s)for t in L(E+1,O)):
     for(N,O)in A:d[N][O]=3
 return d