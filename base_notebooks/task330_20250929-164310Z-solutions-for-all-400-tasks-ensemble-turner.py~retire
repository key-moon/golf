from collections import Counter,deque
def p(d,f=range):
 o,n=len(d),len(d[0]);M=Counter(B for A in d for B in A).most_common(1)[0][0];N=[A[:]for A in d];E=[[0]*n for A in f(o)]
 for A in f(o):
  for B in f(n):
   if d[A][B]!=M and not E[A][B]:
    i=d[A][B];J=deque([(A,B)]);E[A][B]=1;K=[]
    while J:
     F,G=J.popleft();K.append((F,G))
     for(S,P)in((1,0),(-1,0),(0,1),(0,-1)):
      C,D=F+S,G+P
      if 0<=C<o and 0<=D<n and not E[C][D]and d[C][D]==i:E[C][D]=1;J.append((C,D))
    Q=2if len(K)==6else 1
    for(F,G)in K:N[F][G]=Q
 return N