def p(g):
	A=[A[:]for A in g];E,F=len(A),len(A[0]);from collections import Counter as K,deque
	def P(grid):A=K(B for A in grid for B in A);return min(A,key=lambda c:A[c])
	def R(grid):A=K(B for A in grid for B in A);return max(A,key=lambda c:A[c])
	def N(i,j):
		for(C,D)in((-1,0),(1,0),(0,-1),(0,1)):
			A,B=i+C,j+D
			if 0<=A<E and 0<=B<F:yield(A,B)
	def Q(grid):
		M=True;D=grid;S=R(D);A=[[False]*F for A in range(E)];O=[]
		for B in range(E):
			for C in range(F):
				if A[B][C]:continue
				P=D[B][C]
				if P==S:A[B][C]=M;continue
				Q=P;G=[];H=deque([(B,C)]);A[B][C]=M
				while H:
					I,J=H.popleft()
					if D[I][J]!=Q:continue
					G.append((I,J))
					for(K,L)in N(I,J):
						if not A[K][L]:A[K][L]=M;H.append((K,L))
				if G:O.append((Q,G))
		return O
	def S(points):A=points;B=[A for(A,B)in A];C=[A for(B,A)in A];return min(B),min(C),max(B),max(C)
	def T(points):
		A=points
		if not A:return set()
		B,C,D,E=S(A);F={(A,B)for A in range(B,D+1)for B in range(C,E+1)};return F.difference(set(A))
	def U(i,j,color):return sum(1 for(B,C)in N(i,j)if A[B][C]==color)
	def V(start,direction):
		A,B=direction;A=0 if A==0 else 1 if A>0 else-1;B=0 if B==0 else 1 if B>0 else-1;I,J=start;C=[]
		for D in range(43):
			G,H=I+A*D,J+B*D
			if 0<=G<E and 0<=H<F:C.append((G,H))
		return C
	L=P(A);W=Q(A);M=set();O=set()
	for(c,G)in W:
		H=T(G)
		if not H:continue
		I=next(iter(H));D=None
		for(B,C)in G:
			if U(B,C,L)==2:D=B,C;break
		if D is None:X,Y=min(G);D=X,Y
		Z,a=I[0]-D[0],I[1]-D[1]
		for b in V(I,(Z,a)):M.add(b)
		O|=H
	J=[A[:]for A in A]
	for(B,C)in M:J[B][C]=L
	for(B,C)in O:J[B][C]=0
	return J