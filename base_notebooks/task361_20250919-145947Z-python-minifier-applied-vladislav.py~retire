j=range
A=enumerate
def W(p,c,E,k):
	for A in j(c,c+k):
		for B in j(E,E+k):
			if A<len(p)and B<len(p[0]):
				if p[A][B]==0:return 0
	return 1
def l(p):
	E,B=len(p),len(p[0])
	for A in j(B-2,1,-1):
		for C in j(0,E-A):
			for D in j(0,B-A):
				if W(p,C,D,A):return C,D,A
	return-1
def N(p):
	A=0
	for B in p:
		for C in B:
			if C:A+=1
	return A
def b(p,e,K,w,k):
	A=0
	for B in j(e-k,e+w+k):
		for C in j(K-k,K+w+k):
			if p[B][C]:A+=1
	return A
def a(p):
	B,C,D=l(p);E=N(p);A=1
	while 1:
		if E==b(p,B,C,D,A):return D+2*A,B-A,C-A
		A+=1
def C(L):
	G,E=len(L),len(L[0]);B=[A[:]for A in L]
	for(C,F)in A(L):
		for(D,H)in A(F):
			if B[D][E-1-C]==0:B[D][E-1-C]=L[C][D]
	return B
def p(L):
	A,B,D=a(L);G=[[0]*A for B in j(A)]
	for E in j(B,B+A):
		for F in j(D,D+A):G[E-B][F-D]=L[E][F]
	G=C(C(C(G)));H=[A[:]for A in L]
	for E in j(B,B+A):
		for F in j(D,D+A):H[E][F]=G[E-B][F-D]
	return H