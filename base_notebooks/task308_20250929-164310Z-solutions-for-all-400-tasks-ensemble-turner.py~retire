def X(a):
 o={}
 for C in a:
  for a in C:o[a]=o.get(a,0)+1
 return max(o,key=o.get)
def p(a):
 R,S=len(a),len(a[0]);N=X(a);C={}
 for r in range(R):
  for i in range(S):
   o=a[r][i]
   if o==N:continue
   C.setdefault(o,[]).append((r,i))
 if not C:return a
 s={}
 for(o,a)in C.items():r=[o[0]for o in a];H=[o[1]for o in a];D=max(r)-min(r)+1;K=max(H)-min(H)+1;s[o]=D,K
 d=max(o for(o,a)in s.values());M=max(o for(a,o)in s.values());O=[[N]*M for o in range(d)]
 for(o,a)in C.items():
  r=[o[0]for o in a];H=[o[1]for o in a];T,U=min(r),min(H);D,K=s[o];V=(d-D)//2;W=(M-K)//2
  for(r,i)in a:
   P=r-T+V;Q=i-U+W
   if 0<=P<d and 0<=Q<M:O[P][Q]=o
 return O
