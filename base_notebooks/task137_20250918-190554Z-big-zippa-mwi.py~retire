def p(g):
	A=[A[:]for A in g];D,E=len(A),len(A[0]);from collections import Counter as U;J=U(B for A in A for B in A);K=min(J,key=lambda c:J[c]);B=[(B,C)for B in range(D)for C in range(E)if A[B][C]==K]
	if not B:return[A[:]for A in g]
	F=min(A for(A,B)in B);V=max(A for(A,B)in B);G=min(A for(B,A)in B);W=max(A for(B,A)in B);L=F+(V-F)//2;M=G+(W-G)//2;N=L-F;O=M-G
	def X(mask,a,b):
		A=mask;B,C=a;D,E=b;F,G=(B,D)if B<=D else(D,B);H,I=(C,E)if C<=E else(E,C)
		for J in range(F,G+1):A.add((J,H));A.add((J,I))
		for K in range(H,I+1):A.add((F,K));A.add((G,K))
	P=set();Y=max(D,E)
	for C in range(0,Y):
		Z=C*N,C*O;a=-C*N,-C*O;Q=set();X(Q,Z,a)
		for(H,I)in Q:
			R,S=L+H,M+I
			if 0<=R<D and 0<=S<E:P.add((R,S))
	T=[A[:]for A in A]
	for(H,I)in P:T[H][I]=K
	return T