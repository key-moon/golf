def solve_2bcee788(I):
	q=False;e=True;G,H=len(I),len(I[0]);f=[B for A in I for B in A];g=max(set(f),key=f.count);T=[[q]*H for A in range(G)];Y=[]
	for A in range(G):
		for B in range(H):
			if I[A][B]==g or T[A][B]:continue
			h=I[A][B];Z=[(A,B)];T[A][B]=e;a=[]
			while Z:
				b,c=Z.pop()
				if I[b][c]!=h:continue
				a.append((b,c))
				for(r,s)in((1,0),(-1,0),(0,1),(0,-1)):
					J,K=b+r,c+s
					if 0<=J<G and 0<=K<H and not T[J][K]and I[J][K]==h:T[J][K]=e;Z.append((J,K))
			if a:Y.append(a)
	t=max(Y,key=len);u=min(Y,key=len)
	def i(cells):A=cells;B=[A for(A,B)in A];C=[A for(B,A)in A];D,E=min(B),max(B);F,G=min(C),max(C);return D,F,E,G
	C,D,L,M=i(t);N,O,U,V=i(u);P=C+(L-C+1)//2;E=D+(M-D+1)//2;Q=N+(U-N+1)//2;F=O+(V-O+1)//2
	if P==Q:d=0,1 if E<F else-1
	elif E==F:d=1 if P<Q else-1,0
	elif P<Q:d=1,1 if E<F else-1
	else:d=-1,1 if E<F else-1
	R=[list(A)for A in I]
	for A in range(G):
		for B in range(H):
			if R[A][B]==g:R[A][B]=3
	W=[A[D:M+1]for A in R[C:L+1]];A0=U-N+1;A1=V-O+1;j=not(M<O or V<D);k=not(L<N or U<C)
	if j and not k:X=q
	elif k and not j:X=e
	else:X=abs(P-Q)<=abs(E-F)
	W=[A[::-1]for A in W]if X else W[::-1];v=L-C+1;w=M-D+1
	if X:
		if F>=E:S=(M+O)/2.
		else:S=(V+D)/2.
		l=C;m=int(round(2*S-D-(w-1)))
	else:
		if Q>=P:S=(L+N)/2.
		else:S=(U+C)/2.
		l=int(round(2*S-C-(v-1)));m=D
	for(x,y)in enumerate(W):
		for(z,n)in enumerate(y):
			if n==3:continue
			o,p=l+x,m+z
			if 0<=o<G and 0<=p<H:R[o][p]=n
	return tuple(tuple(A)for A in R)
def p(g):A=tuple(tuple(A)for A in g);B=solve_2bcee788(A);return[list(A)for A in B]