def p(g,L=len,R=range):
	D,E=L(g),L(g[0])
	for A in R(D//2):
		if len(set(g[A]))>2:g[A+D//2+1]=g[A][:]
	C=g[0].count(4)+1
	for A in R(D//2,D):
		if len(set(g[A]))>2:g[A-D//2-1]=g[A][:]
	C=g[0].count(4)+1
	if C==1:
		for A in R(D//2):
			for B in R(E):G=max([g[A][B],g[A+D//2+1][B]]);g[A][B]=G;g[A+D//2+1][B]=G
	for A in R(D):
		for B in R(E//C):
			for F in R(C):g[A][B]=max([g[A][B],g[A][B+(E//C+1)*F]]);g[A][B+(E//C+1)*F]=max([g[A][B],g[A][B+(E//C+1)*F]])
	for A in R(D):
		for B in R(E//C):
			for F in R(C):g[A][B]=max([g[A][B],g[A][B+(E//C+1)*F]]);g[A][B+(E//C+1)*F]=max([g[A][B],g[A][B+(E//C+1)*F]])
	return g