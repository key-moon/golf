def p(s):
 from collections import deque,Counter as V;C,Q=range,len;I,l=Q(s),Q(s[0]);K=[[0]*l for N in C(I)];L=[[0]*l for N in C(I)]
 for M in C(I):
  for N in C(l):
   if s[M][N]and not L[M][N]:
    P=deque([(M,N)]);L[M][N]=1;R=[];S=V()
    while P:
     N,B=P.popleft();R.append((N,B));S[s[N][B]]+=1
     for(W,X)in((1,0),(-1,0),(0,1),(0,-1)):
      G,D=N+W,B+X
      if 0<=G<I and 0<=D<l and s[G][D]and not L[G][D]:L[G][D]=1;P.append((G,D))
    T,U=[N for(N,B)in S.most_common(2)];O=[(N,B)for(N,B)in R if s[N][B]==U];E,F,D=min(N for(N,B)in O),min(N for(B,N)in O),max(N for(N,B)in O)-min(N for(N,B)in O)+1
    for N in C(E-D-1,E+2*D+1):
     for B in C(F-D-1,F+2*D+1):
      if(N<E-1or N>E+D)and(B<F-1or B>F+D):continue
      K[N][B]=T
    for N in C(E-1,E+D+1):
     for B in C(F-1,F+D+1):K[N][B]=U
    for N in C(E,E+D):
     for B in C(F,F+D):K[N][B]=T
 return K