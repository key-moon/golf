def p(j,A=range):
	I,J=len(j),len(j[0]);D=[A[:]for A in j];E,F=[A for A in A(I)if all(A==8 for A in j[A])];G,H=[B for B in A(J)if all(j[A][B]==8 for A in A(I))]
	for B in A(I):
		for C in A(J):
			if not D[B][C]:
				if B<E and G<C<H:D[B][C]=2
				elif E<B<F and C<G:D[B][C]=4
				elif E<B<F and G<C<H:D[B][C]=6
				elif E<B<F and C>H:D[B][C]=3
				elif B>F and G<C<H:D[B][C]=1
	return D