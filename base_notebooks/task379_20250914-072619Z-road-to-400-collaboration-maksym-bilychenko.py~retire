def p(a):
    R=range;T=lambda g:[list(r) for r in zip(*g)]
    g=a;tr=0
    if not any(all(x==8 for x in r) for r in a): g,tr=T(a),1
    h,w=len(g),len(g[0]);o=[r[:] for r in g]
    B=[i for i in R(h) if all(x==8 for x in g[i])]
    for i in R(h):
        for j in R(w):
            if g[i][j]!=2: continue
            for r in (max([x for x in B if x<i],default=None),min([x for x in B if x>i],default=None)):
                if r is None: continue
                for y in (r-1,r,r+1):
                    if 0<=y<h:
                        for x in (j-1,j,j+1):
                            if 0<=x<w:o[y][x]=2 if (y==r and x==j) else 8
                s=1-2*(r<i)
                for y in R(i,r-s,s): o[y][j]=2
    return T(o) if tr else o