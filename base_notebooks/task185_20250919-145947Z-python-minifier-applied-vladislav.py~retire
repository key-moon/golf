def p(g):
	B=None;from collections import Counter;A,C=len(g),len(g[0]);b=[A[0]if all(B==A[0]for B in A)else B for A in g];N=[]
	for c in range(C):E=[g[A][c]for A in range(A)];N.append(E[0]if all(A==E[0]for A in E)else B)
	from collections import Counter as O;P=O(A for A in b+N if A is not B);D=P.most_common(1)[0][0]if P else O(B for A in g for B in A).most_common(1)[0][0];F=[sum(1 for A in A if A==D)for A in g];G=[sum(1 for A in range(A)if g[A][B]==D)for B in range(C)];d=max(F)if F else 0;e=max(G)if G else 0;Q=4;H=[A for(A,B)in enumerate(F)if B>=d-Q];I=[A for(A,B)in enumerate(G)if B>=e-Q]
	def R(seps,N):A=[-1]+seps+[N];return[(A[B]+1,A[B+1])for B in range(len(A)-1)if A[B+1]-A[B]>1]
	J=R(H,A);K=R(I,C)
	if not J or not K:return[list(A)for A in g]
	L=[(A,B)for A in range(A)for B in range(C)if g[A][B]not in(0,D)]
	if L and len(H)>=4 and len(I)>=4:
		def S(seps,axis=0):
			D=seps;C=B
			for A in range(len(D)-3):
				F,G=D[A],D[A+3]
				if axis==0:E=sum(1 for(A,B)in L if F<=A<=G)
				else:E=sum(1 for(B,A)in L if F<=A<=G)
				if C is B or E>C[0]:C=E,A
			A=C[1]if C else 0;return D[A:A+4]
		T=S(H,0);U=S(I,1);J=[(T[A],T[A+1])for A in range(3)];K=[(U[A],U[A+1])for A in range(3)]
	V=[]
	for(W,X)in J:
		Y=[]
		for(Z,a)in K:f=[g[W][Z],g[W][a],g[X][Z],g[X][a]];M=[A for A in f if A not in(0,D)];Y.append(M[0]if len(M)==4 and len(set(M))==1 else 0)
		V.append(Y)
	return V