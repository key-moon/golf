def p(g):
	G,H=len(g),len(g[0]);P=[A[:]for A in g];E=[[False]*H for A in range(G)];T=[(1,0),(-1,0),(0,1),(0,-1)]
	for C in range(G):
		for D in range(H):
			if g[C][D]!=0 or E[C][D]:continue
			I=[(C,D)];E[C][D]=True;F=[(C,D)];J=K=C;L=M=D
			while I:
				N,O=I.pop()
				for(U,V)in T:
					A,B=N+U,O+V
					if 0<=A<G and 0<=B<H and not E[A][B]and g[A][B]==0:
						E[A][B]=True;I.append((A,B));F.append((A,B))
						if A<J:J=A
						if A>K:K=A
						if B<L:L=B
						if B>M:M=B
			Q=K-J+1;R=M-L+1;S=4
			if Q==R and len(F)>1 and len(F)==Q*R:S=3
			for(N,O)in F:P[N][O]=S
	return P