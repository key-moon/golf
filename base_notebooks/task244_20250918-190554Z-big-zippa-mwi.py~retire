def p(g,V=range):A,B=len(g),len(g[0]);C=[-1]+[A for A in V(A)if len({*g[A]})==1]+[A];D=[-1]+[B for B in V(B)if len({g[A][B]for A in V(A)})==1]+[B];E=[[g[A+1][B+1]for(B,C)in zip(D,D[1:])if B+1<C-1]for(A,B)in zip(C,C[1:])if A+1<B-1];return[A[::-1]for A in E]