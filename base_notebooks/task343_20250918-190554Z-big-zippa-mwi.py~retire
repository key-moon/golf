def solve_d8c310e9(I):
	A=[A[:]for A in I];O,E=len(A),len(A[0]);from collections import Counter as U;V=[B for A in A for B in A];P=U(V).most_common(1)[0][0]
	def W(si,sj):
		D=[(si,sj)];H={(si,sj)};I=[]
		while D:
			F,G=D.pop();I.append((F,G,A[F][G]))
			for(J,K)in((1,0),(-1,0),(0,1),(0,-1)):
				B,C=F+J,G+K
				if 0<=B<O and 0<=C<E and(B,C)not in H and A[B][C]!=P:H.add((B,C));D.append((B,C))
		return I
	F=None
	for C in range(O):
		for D in range(E):
			if A[C][D]!=P:F=C,D;break
		if F:break
	if not F:return[A[:]for A in I]
	G=W(*F);X=min(A for(A,B,C)in G);H=min(A for(B,A,C)in G);B={}
	for(C,D,K)in G:B.setdefault(D-H,[]).append((C-X,K))
	for L in B:B[L].sort();B[L]=tuple(B[L])
	M=max(B)+1
	def Q(j):return B.get(j,tuple())
	J=M
	for N in range(1,M+1):
		R=True
		for S in range(0,M-N):
			if Q(S)!=Q(S+N):R=False;break
		if R:J=N;break
	for(C,D,K)in G:
		Y=D-H
		for Z in range(0,(E-H+J-1)//J+1):
			T=H+Y+Z*J
			if 0<=T<E:A[C][T]=K
	return A
def p(g):return solve_d8c310e9([A[:]for A in g])