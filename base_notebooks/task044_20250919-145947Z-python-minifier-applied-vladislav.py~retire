def solve_228f6490(I):
	f=None;e=True;C='color';A='idx'
	if not I or not I[0]:return[list(A)for A in I]
	G,H=len(I),len(I[0])
	def g(i,j):
		for(C,D)in((1,0),(-1,0),(0,1),(0,-1)):
			A,B=i+C,j+D
			if 0<=A<G and 0<=B<H:yield(A,B)
	L=[[False]*H for A in range(G)];T=[]
	for M in range(G):
		for N in range(H):
			if L[M][N]:continue
			U=I[M][N];V=[(M,N)];L[M][N]=e;W=[]
			while V:
				X,Y=V.pop()
				if I[X][Y]!=U:continue
				W.append((X,Y))
				for(O,P)in g(X,Y):
					if not L[O][P]and I[O][P]==U:L[O][P]=e;V.append((O,P))
			if W:T.append({C:U,A:W})
	def B(indices):A=indices;B=min(A for(A,B)in A);C=min(A for(B,A)in A);return B,C
	def r(indices):return any(A in(0,G-1)or B in(0,H-1)for(A,B)in indices)
	def J(indices):A=indices;C,D=B(A);return tuple(sorted((A-C,B-D)for(A,B)in A))
	K={}
	for Z in T:
		if Z[C]==0:continue
		s=J(Z[A]);K.setdefault(s,[]).append(Z)
	D=[B for B in T if B[C]==0 and not r(B[A])and J(B[A])in K];from collections import Counter as a;b=a(A for B in I for A in B if A!=0);h=max(b,key=b.get)if b else f
	def t(indices):
		A=set()
		for(C,D)in indices:
			for(E,F)in g(C,D):
				B=I[E][F]
				if B!=0:A.add(B)
		return A
	if h is not f:
		i=[B for B in D if all(A==h for A in t(B[A]))]
		if len(i)>=2:D=i
	D.sort(key=lambda c:len(c[A]),reverse=e)
	if len(D)<2:return[A[:]for A in I]
	E,F=D[0],D[1]
	def j(h):E=J(h[A]);B=K.get(E,[]);D=[A for A in B if A[C]!=5];return D if D else list(B)
	k,l=j(E),j(F)
	if not k or not l:return[A[:]for A in I]
	c,u=J(E[A]),J(F[A]);Q=R=f
	if c==u:
		S=[A for A in K.get(c,[])if A[C]!=5]
		if len(S)<2:S=list(K.get(c,[]))
		if len(S)<2:return[A[:]for A in I]
		v=sorted([(B(E[A]),0,E),(B(F[A]),1,F)]);m=sorted(S,key=lambda s:B(s[A]));n,o=m[0],m[1]
		if v[0][1]==0:Q,R=n,o
		else:Q,R=o,n
	else:
		from collections import Counter as a;w=a(B for A in I for B in A)
		def p(cands,hole):
			D=cands
			if not D:return
			E=B(hole[A]);return min(D,key=lambda o:(w.get(o[C],0),abs(B(o[A])[0]-E[0])+abs(B(o[A])[1]-E[1]),o[C]))
		Q,R=p(k,E),p(l,F)
	d=[A[:]for A in I]
	def q(src,hole):
		D=src
		if not D:return
		I=B(D[A]);J=B(hole[A]);M=J[0]-I[0];N=J[1]-I[1]
		for(E,F)in D[A]:d[E][F]=0
		O=D[C]
		for(E,F)in D[A]:
			K,L=E+M,F+N
			if 0<=K<G and 0<=L<H:d[K][L]=O
	q(Q,E);q(R,F);return d
def p(g):
	try:return solve_228f6490([A[:]for A in g])
	except Exception:return[list(A)for A in g]