def p(I,n=range):
 L,o=len(I),len(I[0]);D=[list(A)for A in I];C,N=[],set()
 for A in n(L):
  for B in n(o):
   E=I[A][B]
   if E!=0:C.append((A,B,E));N.add(E)
 if not C:return I
 F=sorted(N)
 def S(E):return F[0]if len(F)==1or E==F[1]else F[1]
 for(A,B,E)in C:
  T=S(E)
  for s in(-1,0,1):
   for E in(-1,0,1):
    if s==0and E==0:continue
    I,E=A+s,B+E
    if 0<=I<L and 0<=E<o:D[I][E]=T
 L=min(A for(A,B,B)in C);H=max(A for(A,B,B)in C);J=min(B for(A,B,A)in C);e=max(B for(A,B,A)in C)
 if e>J:
  for B in n(J+1,e):
   if min(B-J,e-B)%2==0:D[L][B]=5;D[H][B]=5
 if H>L:
  for A in n(L+1,H):
   if min(A-L,H-A)%2==0:D[A][J]=5;D[A][e]=5
 return D
