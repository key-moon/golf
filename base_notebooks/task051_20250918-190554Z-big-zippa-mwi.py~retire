def p(j):
	D=range;L=[A[:]for A in j];E,F=len(j),len(j[0]);I={}
	for A in D(E):
		for B in D(F):
			if j[A][B]:I[j[A][B]]=I.get(j[A][B],0)+1
	A,B,M=next((A,B,j[A][B])for A in D(E)for B in D(F)if j[A][B]and I[j[A][B]]==1)
	for(G,H)in[(0,1),(1,0),(0,-1),(-1,0)]:
		J,K=A+G,B+H
		if(J<0)|(J>=E)|(K<0)|(K>=F)|(j[J][K]==0):
			C=1
			while(0<=A-C*G<E)&(0<=B-C*H<F):
				if j[A-C*G][B-C*H]==0:L[A-C*G][B-C*H]=M
				C+=1
	return L