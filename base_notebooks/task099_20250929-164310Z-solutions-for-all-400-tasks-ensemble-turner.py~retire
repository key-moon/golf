def p(g,f=range):
 from collections import deque,Counter as N;E,o=len(g),len(g[0]);U=N(s for A in g for s in A).most_common(1)[0][0];K=[A[:]for A in g];F=[[0]*o for A in f(E)]
 for s in f(E):
  for s in f(o):
   if g[s][s]==1and not F[s][s]:
    L=deque([(s,s)]);F[s][s]=1;A=[]
    while L:
     n,s=L.popleft();A.append((n,s))
     for(V,W)in((1,0),(-1,0),(0,1),(0,-1)):
      C,O=n+V,s+W
      if 0<=C<E and 0<=O<o and not F[C][O]and g[C][O]==1:F[C][O]=1;L.append((C,O))
    a=min(A for(A,s)in A);r=max(A for(A,s)in A);Q=min(A for(s,A)in A);i=max(A for(s,A)in A);X=set(A);S=[g[A][s]for A in f(a,r+1)for s in f(Q,i+1)if(A,s)not in X]
    if not S:continue
    l=N(S);Y=min(l.values());Z=min(A for(A,s)in l.items()if s==Y)
    for n in f(a,r+1):
     M=n-1
     if 0<=M<E:
      for s in f(Q,i+1):
       if K[M][s]==U:K[M][s]=Z
 return K