a=len
e=range
L=[[0,1],[0,-1],[1,0],[-1,0]]
def p(g):
 D,E=a(g),a(g[0]);J=sum(g,[]);C=sorted([[J.count(A),A]for A in set(J)])
 for A in e(D):
  for s in e(E):
   if g[A][s]==C[1][1]:
    for(F,G)in L:
     if 0<=A+F<D and 0<=s+G<E and g[A+F][s+G]==C[2][1]:
      for H in e(20):
       if 0<=A+F*H<D and 0<=s+G*H<E:
        R=g[A+F*H][s+G*H]
        if R==C[0][1]:g[A][s]=0
 for M in range(4):
  g=list(map(list,zip(*g[::-1])));D,E=a(g),a(g[0])
  for A in e(D):
   if g[A].count(0)>0:
    I=0
    for s in e(E):
     if g[A][s]==C[0][1]and g[A].count(0)>0and g[A].index(0)>s:I=1
     if I:
      if g[A][s]==C[2][1]:g[A][s]=C[0][1]
      elif g[A][s]==0:I=0
 g=[[C[1][1]if A==0 else A for A in A]for A in g];return g