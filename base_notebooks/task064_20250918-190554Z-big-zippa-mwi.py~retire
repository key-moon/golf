L=len
R=range
P=[[0,1],[0,-1],[1,0],[-1,0]]
def p(g):
	D,E=L(g),L(g[0]);J=sum(g,[]);C=sorted([[J.count(A),A]for A in set(J)])
	for A in R(D):
		for B in R(E):
			if g[A][B]==C[1][1]:
				for(F,G)in P:
					if 0<=A+F<D and 0<=B+G<E and g[A+F][B+G]==C[2][1]:
						for H in R(20):
							if 0<=A+F*H<D and 0<=B+G*H<E:
								K=g[A+F*H][B+G*H]
								if K==C[0][1]:g[A][B]=0
	for M in range(4):
		g=list(map(list,zip(*g[::-1])));D,E=L(g),L(g[0])
		for A in R(D):
			if g[A].count(0)>0:
				I=0
				for B in R(E):
					if g[A][B]==C[0][1]and g[A].count(0)>0 and g[A].index(0)>B:I=1
					if I:
						if g[A][B]==C[2][1]:g[A][B]=C[0][1]
						elif g[A][B]==0:I=0
	g=[[C[1][1]if A==0 else A for A in A]for A in g];return g