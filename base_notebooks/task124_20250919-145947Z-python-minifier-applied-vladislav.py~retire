def p(g):
	E=[A[:]for A in g];V,B=len(E),len(E[0]);from collections import Counter as W;P=W(B for A in E for B in A);X=max(P,key=lambda c:P[c]);D=[(A,C,E[A][C])for A in range(V)for C in range(B)if E[A][C]!=X]
	if not D:return[[0]*B for A in range(B)]
	Q=min(A for(A,B,B)in D);C=max(A for(A,B,B)in D);Y=min(B for(A,B,A)in D);Z=max(B for(A,B,A)in D);K=C-Q+1;e=Z-Y+1;R={(A-Q,B):C for(A,B,C)in D};L=K
	for F in range(1,K):
		S=True
		for((H,G),f)in R.items():
			if H-F>=0 and(H-F,G)not in R:S=False;break
		if S:L=F;break
	M=[[0 for A in range(B)]for A in range(B)]
	def T(di,dj):
		for(E,F,G)in D:
			A,C=E+di,F+dj
			if 0<=A<B and 0<=C<B:M[A][C]=G
	T(0,0)
	if L!=K:
		for F in range(1,9):T(F*L,0)
	else:
		A={}
		for(H,G,I)in D:A.setdefault(H,[]).append((G,I))
		if C-2 in A:a=min(A for(A,B)in A[C]);b=min(A for(A,B)in A[C-2]);N=a-b
		elif C-1 in A and A[C-1]:N=min(A for(A,B)in A[C])-min(A for(A,B)in A[C-1])
		else:N=0
		for J in range(C+1,B):
			c=J-2;d=A.get(c,A.get(J-1,[]));U=[]
			for(G,I)in d:
				O=G+N
				if 0<=O<B:M[J][O]=I;U.append((O,I))
			A[J]=U
	return M