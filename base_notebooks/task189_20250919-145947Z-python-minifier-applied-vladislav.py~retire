def p(g):
	A=None;M,N=len(g),len(g[0]);J=[(A,B)for A in range(M)for B in range(N)if g[A][B]==3]
	if not J:return[A[:]for A in g]
	W=[A for(A,B)in J];X=[A for(B,A)in J];F,O,Y,i=min(W),min(X),max(W),max(X);P=[A[O:i+1]for A in g[F:Y+1]];j=[(A,B)for A in range(len(P))for B in range(len(P[0]))if P[A][B]==0];B=next((A for(A,B)in enumerate(g)if all(A==8 for A in B)),A);C=next((A for A in range(N)if all(g[B][A]==8 for B in range(M))),A);Q=A
	if B is not A and C is not A:
		def Z(i,j):return 0 if i<B and j<C else 1 if i<B and j>C else 2 if i>B and j<C else 3 if i>B and j>C else A
		R=next((Z(B,C)for(B,C)in J if Z(B,C)is not A),A)
		if R is not A:S=range(0,B)if R in(0,1)else range(B+1,M);T=range(0,C)if R in(0,2)else range(C+1,N);U,V=min(S)if S else 0,min(T)if T else 0;Q=[(A-U,B-V)for A in S for B in T if g[A][B]==0]
	a=[[0 if A in(3,8)else A for A in A]for A in g];G=[A for(A,B)in enumerate(a)if len(set(B))!=1];K=[a[A]for A in G]
	if not K:return[A[:]for A in g]
	k=list(zip(*K));L=[A for(A,B)in enumerate(k)if len(set(B))!=1];D=[[K[A][B]for B in L]for A in range(len(K))]
	if D and G and L and F in G:
		b=G.index(F);l,m=max(0,b),min(len(D)-1,b+(Y-F))
		for E in range(len(D[0])):
			c={D[A][E]for A in range(l,m+1)}
			if c and len(c)==1:
				for H in range(len(D)):D[H][E]=0
	I=[[B for A in A for B in[A]*3]for A in D for B in range(3)]
	if I:
		d,e=len(I),len(I[0])
		if Q is not A:
			for(H,E)in Q:
				if 0<=H<d and 0<=E<e:I[H][E]=0
		else:
			U=G.index(F)if F in G else 0;V=L.index(O)if O in L else 0
			for(H,E)in j:
				f,h=U+H,V+E
				if 0<=f<d and 0<=h<e:I[f][h]=0
	return I