def Z(S,t):return len(set([l[t]for l in S]))
def p(s):
 o=enumerate;h,H=len(s),len(s[0]);n=Z(s,0)+Z(s,-1)<len(set(s[0]))+len(set(s[-1]));s=[[t if t!=5else 0for t in t]for t in s]
 for(t,i)in o(s):
  for(l,H)in o(i):
   if n:s[t][l]=max([s[0][l],s[-1][l]])
   else:s[t][l]=max([s[t][0],s[t][-1]])
 if n:s=[[t for t in t if t>0]for t in s];s=s[:len(s[0])]
 else:s=[t for t in s if sum(t)>0];s=[t[:len(s)]for t in s]
 return s