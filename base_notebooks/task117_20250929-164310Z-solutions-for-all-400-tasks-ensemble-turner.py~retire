def p(I):
 G=False;D=None;A=True;u,v=len(I),len(I[0])
 def a(G):A=[B for A in G for B in A];return max(set(A),key=A.count)
 def b(G):return tuple(tuple(A)for A in zip(*G[::-1]))
 def c(G):return G[::-1]
 def d(G):return tuple(tuple(A[::-1])for A in G)
 def B(idx):A=[A for(A,B)in idx];B=[A for(B,A)in idx];return min(A),min(B),max(A),max(B)
 def K(idx):A,C,D,E=B(idx);return A+(D-A)//2,C+(E-C)//2
 def e(G,u,l,d,a):return tuple(tuple(G[A][l:a+1])for A in range(u,d+1))
 def P(G,t):
  A=[list(A)for A in G]
  for(D,(B,C))in t:
   if 0<=B<len(A)and 0<=C<len(A[0]):A[B][C]=D
  return tuple(tuple(A)for A in A)
 def Q(t,di,dj):return{(A,(B+di,C+dj))for(A,(B,C))in t}
 def E(G,e=A,s=A):
  B=s;C=a(G)if B else D;E,F=len(G),len(G[0])
  if e:
   J=sorted({G[A][D]for A in range(E)for D in range(F)if not B or G[A][D]!=C});I=[]
   for H in J:
    if B and H==C:continue
    A=[(A,B)for A in range(E)for B in range(F)if G[A][B]==H]
    if A:I.append({(H,(A,B))for(A,B)in A})
   return I
  else:
   A=[(A,D)for A in range(E)for D in range(F)if not B or G[A][D]!=C]
   if B:A=[(A,B)for(A,B)in A if G[A][B]!=C]
   if not A:return[]
   return[{(G[A][B],(A,B))for(A,B)in A}]
 def L(G,t):F=[(A,B)for(C,(A,B))in t];A,C,D,E=B(F);return e(G,A,C,D,E),(A,C,D,E)
 def R(t,G):A,B=L(G,t);return A==b(A)
 f=E(I,e=A,s=A);g=sorted(f,key=lambda o:B([A for(B,A)in o]));H=D
 for C in g:
  if R(C,I):H=C;break
 if H is D:return I
 J=K([A for(B,A)in H]);S=E(I,e=G,s=A)
 if not S:return I
 s=sorted(S,key=lambda o:B([A for(B,A)in o]))[0];s,j=L(I,s);M=c(s);T=E(M,e=G,s=A)
 if not T:return I
 k=sorted(T,key=lambda o:B([A for(B,A)in o]))[0];l=E(M,e=A,s=A);O=D
 for C in sorted(l,key=lambda o:B([A for(B,A)in o])):
  if R(C,M):O=C;break
 if O is D:return I
 U=K([A for(B,A)in O]);m,n=J[0]-U[0],J[1]-U[1];F=P(I,Q(k,m,n));V=E(F,e=G,s=A)
 if not V:return F
 o=sorted(V,key=lambda o:B([A for(B,A)in o]))[0];p,j=L(F,o);W=d(p);O=E(W,e=G,s=A)
 if not O:return F
 q=sorted(O,key=lambda o:B([A for(B,A)in o]))[0];Y=E(W,e=A,s=A)
 if not Y:return F
 a=next(iter(H))[0];O=D
 for C in sorted(Y,key=lambda o:B([A for(B,A)in o])):
  if next(iter(C))[0]==a:O=C;break
 if O is D:return F
 E=K([A for(B,A)in O]);s,t=J[0]-E[0],J[1]-E[1];return P(F,Q(q,s,t))