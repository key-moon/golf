def p(a,o=range):
 A=len(a);c=len(a[0]);t=len({*sum(a,[])}-{0})
 a=[[a[s//t][l//t]for l in o(c*t)]for s in o(A*t)];A*=t;c*=t
 for i in o(min(A,c),0,-1):
  for s in o(A-i+1):
   for l in o(c-i+1):
    n=a[s][l]
    if n and all(t[l:l+i]==[n]*i for t in a[s:s+i]):
     for R,i in(-1,-1),(-1,i),(i,-1),(i,i):
      e=s+R;K=l+i
      while-1<e<A and-1<K<c and not a[e][K]:a[e][K]=2;e+=R>0 or-1;K+=i>0 or-1
     return a