E=enumerate
d=len
def p(t):
 s=sum(t,[]);i=sorted([[s.count(n),n]for n in set(s)if n>0]);T=[[r,n]for(n,s)in E(t)for(r,s)in E(s)if s==i[-1][1]];s=sum(T,[]);r=s[::2];s=s[1::2];n=t[min(s):max(s)+1];n=[n[min(r):max(r)+1][:]for n in n]
 if d(n)<3:
  if n[0].count(0)>0:n=[[0,0,0]]+n
  else:n=n+[[0,0,0]]
 if d(n[0])<3:
  if[n[0][0],n[1][0],n[2][0]].count(0)>0:n=[[0]+n for n in n]
  else:n=[n+[0]for n in n]
 n=[[i[0][1]if n==0else n for n in n]for n in n];return n
