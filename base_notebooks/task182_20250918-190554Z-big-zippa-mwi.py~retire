def p(g):
	M=False;from collections import Counter as N,deque;F,G=len(g),len(g[0]);S=N(B for A in g for B in A).most_common(1)[0][0]
	def T(si,sj):
		D=g[si][sj];C=deque([(si,sj)]);E={(si,sj)};H=[(si,sj)]
		while C:
			I,J=C.popleft()
			for(K,L)in((1,0),(-1,0),(0,1),(0,-1)):
				A,B=I+K,J+L
				if 0<=A<F and 0<=B<G and(A,B)not in E and g[A][B]==D:E.add((A,B));C.append((A,B));H.append((A,B))
		return D,H
	O=[[M]*G for A in range(F)];H=[]
	for B in range(F):
		for C in range(G):
			if g[B][C]!=S and not O[B][C]:
				E,A=T(B,C)
				for(U,V)in A:O[U][V]=True
				H.append((E,A))
	def I(cells):A=cells;B=[A for(A,B)in A];C=[A for(B,A)in A];return min(B),min(C),max(B),max(C)
	def W(cells):
		C=cells;D,E,F,G=I(C);H=set(C)
		for A in range(D,F+1):
			for B in range(E,G+1):
				J=A in(D,F)or B in(E,G)
				if J and(A,B)not in H:return M
				if not J and(A,B)in H:return M
		return True
	J=None
	for(E,A)in H:
		if E==5 and W(A):J=A;break
	if J is None:return[list(A)for A in g]
	K,L,P,Q=I(J);X,Y,Z,a=K+1,L+1,P-1,Q-1;b=[(A,B)for A in range(X,Z+1)for B in range(Y,a+1)];D=[(A,B)for(A,B)in b if g[A][B]!=0]
	if not D:return[list(A)for A in g]
	c=min(A for(A,B)in D);d=min(A for(B,A)in D);e={(A-c,B-d)for(A,B)in D};f=N(g[A][B]for(A,B)in D).most_common(1)[0][0];R=[A[:]for A in g]
	for(E,A)in H:
		K,L,P,Q=I(A);h={(A-K,B-L)for(A,B)in A}
		if h==e:
			for(B,C)in A:R[B][C]=f
	return R