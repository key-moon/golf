def solve_e21d9049(I):
	A=[A[:]for A in I];C,D=len(A),len(A[0]);from collections import Counter as E;M=E([B for A in A for B in A]).most_common(1)[0][0];B=[(B,C)for B in range(C)for C in range(D)if A[B][C]!=M]
	if not B:return A
	N=E(A for(A,B)in B);O=E(A for(B,A)in B);F=max(N,key=N.get);G=max(O,key=O.get);P=sorted((C,A[F][C])for C in range(D)if(F,C)in set(B));Q=sorted((C,A[C][G])for C in range(C)if(C,G)in set(B));H=[A for(B,A)in P];J=[A for(B,A)in Q];T=P[0][0];U=Q[0][0];K=[[M for A in range(D)]for A in range(C)]
	if H:
		L=len(H)
		for R in range(D):K[F][R]=H[(R-T)%L]
	if J:
		L=len(J)
		for S in range(C):K[S][G]=J[(S-U)%L]
	return K
def p(g):return solve_e21d9049([A[:]for A in g])