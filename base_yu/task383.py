# best: 121(xsot ovs att joking mewheni) / others: 123(4atj sisyphus luke Seek mukundan), 135(jailctf merger), 136(natte), 161(2F), 161(biz)
# ========================================================= 121 =========================================================
p=lambda g,c=-3:c*g or p([1<len(a:=[*filter(int,s)])<len(s)and a[0]!=a[1]and[a[0**v]for v in s]or s for s in zip(*g[::-1])],c+1)

# def p(g):
#  for _ in range(4):
#   for i,s in enumerate(g):
#    if len(s)>len(a:=[*filter(int,s)])>1 and a[0]!=a[1]:
#     g[i]=[a[0**v]for v in g[i]]
#   *g,=zip(*g[::-1])
#  return g


# def p(g):
#  u=[s[:]for s in g]
#  for _ in 0,1:
#   for i in range(len(g)):
#    *a,=filter(int,s:=g[i])
#    if a and s.count(a[0])|1==3:
#     l=s.index(0,k:=s.index(a[0]))
#     u[i]=[a[2]]*len(g[0])
#     u[i][k:l]=[a[0]]*(l-k)
#   *g,=zip(*g)
#   *u,=map(list,zip(*u))
#  return u
