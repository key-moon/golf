# best: 105(4atj sisyphus luke Seek mukundan, jailctf merger) / others: 130(xsot ovs att joking mewheni), 143(4atj sisyphus luke Seek), 167(intgrah jimboko awu macaque sammyuri), 170(natte), 194(jacekwl Potatoman)
# ================================================= 105 =================================================
p=lambda g,c=-1,a=0:g*c or p([*zip(*[[(v or(c+3in s)*8)*(a|(a:=a^any(t)))for*t,v in zip(*g,s)]for s in g])],c+1)
